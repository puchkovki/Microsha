Все макросы ставить внутрь do ... while ()
#define log(str, ...)
do {
...
} while (0);

sizeof вычисляется на момент компиляции

После сборки программы макросы заменяются макроопределениями. При вызове же функции под неё выделяется новый стековый кадр, и она выполняется самостоятельно и не зависит от места в коде, откуда была вызвана. Функции выполняют проверку типов: если функция ожидает на входе строку, а получает число, будет выброшена ошибка (или, по крайней мере, предупреждение, в зависимости от компилятора). Макросы в то же время просто заменяют аргумент, который им передан. Явное преимущество макросов перед функциями — производительность.

Раскрыть макросы "gcc -E source.c"

Директива – это указание компилятору выполнить то или иное действие в момент компиляции программы.

Как провертяь, что структура данных влезает на страницу? Ошибка должна быть проверена на момент компиляции. 